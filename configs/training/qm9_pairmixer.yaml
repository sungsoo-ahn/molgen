# QM9 Flow Matching with PairMixer Architecture
# PairMixer: Edge-only backbone with triangle multiplication only (no triangle attention)
# Reference: arXiv:2510.18870 "Triangle Multiplication is All You Need"
output_dir: "data/experiments/qm9_pairmixer"

# Dataset settings
dataset:
  name: "qm9"
  train_split: 0.8
  valid_split: 0.1

# Graph representation settings
graph:
  atom_types: ["C", "N", "O", "F", "H"]
  bond_types: ["none", "single", "double", "triple", "aromatic"]
  max_atoms: 9

# Model architecture (PairMixer)
model:
  architecture: "pairmixer"
  hidden_dim_z: 128  # Edge dimension (main processing track)
  hidden_dim_s: 128  # Node dimension (for aggregation and output)
  num_layers: 6      # Fewer layers needed due to edge-only processing
  num_heads: 4       # For node aggregation attention
  mlp_ratio: 4.0
  dropout: 0.1
  t_embed_dim: 128

# Flow matching settings
flow_matching:
  sigma_min: 0.001

# Sampling settings (for evaluation during training)
sampling:
  num_steps: 100
  method: "heun"

# Training settings
training:
  epochs: 200
  batch_size: 256
  optimizer: "muon"
  learning_rate: 0.001  # For non-Muon params (embeddings, biases)
  muon_lr: 0.02  # Muon LR for 2D weight matrices
  muon_momentum: 0.95
  weight_decay: 0.0  # Muon works better without weight decay
  grad_clip: 1.0
  warmup_epochs: 10
  early_stopping_patience: 20
  eval_interval: 10
  num_eval_samples: 1000
  # Speed optimizations
  mixed_precision: true
  mixed_precision_type: "bf16"
  compile: true

# Data directory
data_dir: "data/raw"

# Weights & Biases
wandb:
  project: "molgen"
  name: "qm9_pairmixer"
